# ุฑุงูููุง ฺฉุงูู Deploy ฺฉุฑุฏู Google Apps Script

ุงู ุฑุงูููุง ุจู ุตูุฑุช ฺฏุงู ุจู ฺฏุงู ู ุจุง ุชูุถุญ ุชูุงู ฺฏุฒููโูุงุ ุดูุง ุฑุง ุฏุฑ Deploy ฺฉุฑุฏู Apps Script ุฑุงูููุง ูโฺฉูุฏ.

## ูุฑุญูู 1: ุจุงุฒ ฺฉุฑุฏู Apps Script Editor

1. Google Sheet ุฎูุฏ ุฑุง ุจุงุฒ ฺฉูุฏ
2. ุงุฒ ููู ุจุงูุง ุฑู **Extensions** ฺฉูฺฉ ฺฉูุฏ
3. **Apps Script** ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
4. ฺฉ ุชุจ ุฌุฏุฏ ุจุงุฒ ูโุดูุฏ ุจุง Apps Script Editor

## ูุฑุญูู 2: ฺฉูพ ฺฉุฑุฏู ฺฉุฏ

1. ุฏุฑ Apps Script Editorุ ฺฉุฏ ูพุดโูุฑุถ ุฑุง ูพุงฺฉ ฺฉูุฏ (ุงฺฏุฑ ฺุฒ ูุณุช)
2. ูุงู `apps-script.js` ุฑุง ุงุฒ ูพุฑูฺู ุจุงุฒ ฺฉูุฏ
3. ุชูุงู ูุญุชูุง ุขู ุฑุง ฺฉูพ ฺฉูุฏ (Ctrl+A ุณูพุณ Ctrl+C)
4. ุฏุฑ Apps Script Editor ูพุณุช ฺฉูุฏ (Ctrl+V)
5. ุฑู ุขฺฉูู **Save** (๐พ) ุฏุฑ ุจุงูุง ฺฉูฺฉ ฺฉูุฏ
6. ฺฉ ูุงู ุจุฑุง ูพุฑูฺู ุงูุชุฎุงุจ ฺฉูุฏ (ูุซูุงู: "Keyhan Financial")

## ูุฑุญูู 3: Deploy ฺฉุฑุฏู Web App

### ฺฏุงู 3.1: ุดุฑูุน Deploy

1. ุฏุฑ Apps Script Editorุ ุฑู ุฏฺฉูู **Deploy** ุฏุฑ ุจุงูุง ฺฉูฺฉ ฺฉูุฏ
2. ุงุฒ ููู ุจุงุฒ ุดุฏูุ **New deployment** ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ

### ฺฏุงู 3.2: ุงูุชุฎุงุจ ููุน Deployment

ฺฉ ูพูุฌุฑู ุฌุฏุฏ ุจุงุฒ ูโุดูุฏ. ุฏุฑ ุจุงูุง ูพูุฌุฑูุ ฺฉูุงุฑ "Select type" ฺฉ ุขฺฉูู โ๏ธ (Settings) ูโุจูุฏ:

1. ุฑู ุขฺฉูู โ๏ธ ฺฉูฺฉ ฺฉูุฏ
2. ุงุฒ ูุณุช ุจุงุฒ ุดุฏูุ **Web app** ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
   - โ๏ธ **ูฺฉุชู**: ฺฏุฒููโูุง ุฏฺฏุฑ ูุซู "API Executable" ุง "Add-on" ุฑุง ุงูุชุฎุงุจ ูฺฉูุฏ

### ฺฏุงู 3.3: ุชูุธูุงุช Deployment

ุญุงูุง ุจุงุฏ ุงู ููุฏูุง ุฑุง ูพุฑ ฺฉูุฏ:

#### ๐ Description (ุชูุถุญุงุช)
- **ฺุณุช**: ฺฉ ุชูุถุญ ฺฉูุชุงู ุจุฑุง ุงู deployment
- **ูุซุงู**: "Keyhan Financial API" ุง "ุณุณุชู ูุงู ฺฉูุงู"
- **ูฺฉุชู**: ุงู ููุฏ ุงุฎุชุงุฑ ุงุณุช ุงูุง ุชูุตู ูโุดูุฏ ูพุฑ ุดูุฏ

#### ๐ค Execute as (ุงุฌุฑุง ุจู ุนููุงู)
ุฏู ฺฏุฒูู ุฏุงุฑุฏ:

**ฺฏุฒูู 1: "Me" (ูู) - โ ุงู ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ**
- ุนู ฺฉุฏ ุจุง ุฏุณุชุฑุณโูุง ุญุณุงุจ Google ุดูุง ุงุฌุฑุง ูโุดูุฏ
- ุจุฑุง ุงุณุชูุงุฏู ุดุฎุต/ุชู ููุงุณุจ ุงุณุช
- Sheet ุจุงุฏ ุจู ุญุณุงุจ ุดูุง ุฏุณุชุฑุณ ุฏุงุดุชู ุจุงุดุฏ

**ฺฏุฒูู 2: "User accessing the web app" (ฺฉุงุฑุจุฑ ฺฉู ุจู ูุจโุงูพ ุฏุณุชุฑุณ ุฏุงุฑุฏ)**
- ุนู ฺฉุฏ ุจุง ุฏุณุชุฑุณโูุง ฺฉุงุฑุจุฑ ฺฉู ุฏุฑุฎูุงุณุช ูโูุฑุณุชุฏ ุงุฌุฑุง ูโุดูุฏ
- ุจุฑุง ุจุฑูุงููโูุง ุนููู ููุงุณุจ ุงุณุช
- โ๏ธ ุจุฑุง ุงู ูพุฑูฺู ุชูุตู ููโุดูุฏ

**โ ุงูุชุฎุงุจ ูพุดููุงุฏ: "Me"**

#### ๐ Who has access (ฺู ฺฉุณุงู ุฏุณุชุฑุณ ุฏุงุฑูุฏ)
ุณู ฺฏุฒูู ุฏุงุฑุฏ:

**ฺฏุฒูู 1: "Only myself" (ููุท ุฎูุฏู)**
- ููุท ุดูุง ูโุชูุงูุฏ ุงุฒ Web App ุงุณุชูุงุฏู ฺฉูุฏ
- โ๏ธ ุงฺฏุฑ ูโุฎูุงูุฏ ุงุฒ ฺฉุงููพูุชุฑ ุง ูุฑูุฑฺฏุฑ ุฏฺฏุฑ ุงุณุชูุงุฏู ฺฉูุฏุ ุงู ฺฏุฒูู ฺฉุงุฑ ููโฺฉูุฏ

**ฺฏุฒูู 2: "Anyone" (ูุฑ ฺฉุณ) - โ ุงู ุฑุง ุจุฑุง ุดุฑูุน ุงูุชุฎุงุจ ฺฉูุฏ**
- ูุฑ ฺฉุณ ฺฉู URL ุฑุง ุฏุงุดุชู ุจุงุดุฏ ูโุชูุงูุฏ ุงุณุชูุงุฏู ฺฉูุฏ
- ุจุฑุง ุชุณุช ู ุงุณุชูุงุฏู ุดุฎุต ููุงุณุจ ุงุณุช
- โ๏ธ ุงููุช ฺฉูุชุฑ (ุงูุง ุจุฑุง ุงุณุชูุงุฏู ุฏุงุฎู ูุดฺฉู ูุฏุงุฑุฏ)

**ฺฏุฒูู 3: "Anyone with Google account" (ูุฑ ฺฉุณ ุจุง ุญุณุงุจ Google)**
- ููุท ฺฉุณุงู ฺฉู ุจุง ุญุณุงุจ Google ูุงฺฏู ฺฉุฑุฏูโุงูุฏ ูโุชูุงููุฏ ุงุณุชูุงุฏู ฺฉููุฏ
- ุงููุช ุจุดุชุฑ
- ุจุฑุง ุงุณุชูุงุฏู ุชู ููุงุณุจ ุงุณุช

**โ ุงูุชุฎุงุจ ูพุดููุงุฏ ุจุฑุง ุดุฑูุน: "Anyone"**
**โ ุจุฑุง ุงุณุชูุงุฏู ุชู: "Anyone with Google account"**

### ฺฏุงู 3.4: Deploy ฺฉุฑุฏู

1. ุจุนุฏ ุงุฒ ูพุฑ ฺฉุฑุฏู ุชูุงู ููุฏูุงุ ุฑู ุฏฺฉูู **Deploy** ุฏุฑ ูพุงู ฺฉูฺฉ ฺฉูุฏ
2. ุงฺฏุฑ ุงููู ุจุงุฑ ุงุณุช ฺฉู Deploy ูโฺฉูุฏุ ฺฉ ูพุงู Authorization ูโุจูุฏ

### ฺฏุงู 3.5: Authorization (ุงุญุฑุงุฒ ููุช)

**โ๏ธ ุงู ูุฑุญูู ููุท ุงููู ุจุงุฑ ุงูุฌุงู ูโุดูุฏ**

1. ฺฉ ูพูุฌุฑู ุฌุฏุฏ ุจุงุฒ ูโุดูุฏ ุจุง ุนููุงู "Authorization required"
2. ุฑู ุฏฺฉูู **Authorize access** ฺฉูฺฉ ฺฉูุฏ
3. ุญุณุงุจ Google ุฎูุฏ ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ (ุงฺฏุฑ ฺูุฏ ุญุณุงุจ ุฏุงุฑุฏ)
4. ฺฉ ุตูุญู ูุดุฏุงุฑ ูโุจูุฏ ฺฉู ูโฺฏูุฏ "Google hasn't verified this app"
   - ุงู ุทุจุน ุงุณุช ฺูู ุดูุง ุฎูุฏุชุงู ุงู app ุฑุง ุณุงุฎุชูโุงุฏ
5. ุฑู **Advanced** ฺฉูฺฉ ฺฉูุฏ (ุฏุฑ ูพุงู ุตูุญู)
6. ุฑู **Go to [ูุงู ูพุฑูฺู ุดูุง] (unsafe)** ฺฉูฺฉ ฺฉูุฏ
   - โ๏ธ ฺฉููู "unsafe" ูฺฏุฑุงูโฺฉููุฏู ูุณุช - ุงู ููุท ุนู Google ุงู app ุฑุง verify ูฺฉุฑุฏู
   - ุจุฑุง ุงุณุชูุงุฏู ุดุฎุต ฺฉุงููุงู ุงูู ุงุณุช
7. ุฑู **Allow** ฺฉูฺฉ ฺฉูุฏ
8. ุญุงูุง ุจู Apps Script Editor ุจุฑูโฺฏุฑุฏุฏ

### ฺฏุงู 3.6: ุฏุฑุงูุช URL

ุจุนุฏ ุงุฒ Deploy ููููุ ฺฉ ุตูุญู ุฌุฏุฏ ุจุงุฒ ูโุดูุฏ ฺฉู ุดุงูู:

1. **Web app URL** - ุงู ููุงู URL ููุฑุฏ ูุงุฒ ุดูุงุณุช!
   - ูุฑูุช ุขู ุดุจู ุงู ุงุณุช: `https://script.google.com/macros/s/AKfycby.../exec`
2. ฺฉ ุฏฺฉูู **Copy** ฺฉูุงุฑ URL ุจุฑุง ฺฉูพ ฺฉุฑุฏู

**โ ุงู URL ุฑุง ฺฉูพ ฺฉูุฏ ู ุฏุฑ ูุงู `config.js` ูุฑุงุฑ ุฏูุฏ**

## ูุฑุญูู 4: ุชุณุช ฺฉุฑุฏู

1. URL ุฑุง ุฏุฑ ูุฑูุฑฺฏุฑ ุจุงุฒ ฺฉูุฏ
2. ุจุงุฏ ฺฉ ูพุงู JSON ุจุจูุฏ (ุงู ุทุจุน ุงุณุช)
3. ุงฺฏุฑ ุฎุทุง ุฏุฏุฏุ ุจู ูุฑุญูู ุจุนุฏ ุจุฑูุฏ

## ูุฑุญูู 5: ุชูุธู config.js

1. ูุงู `config.js` ุฑุง ุฏุฑ ูพุฑูฺู ุจุงุฒ ฺฉูุฏ
2. URL ฺฉู ฺฉูพ ฺฉุฑุฏุฏ ุฑุง ุฌุงฺฏุฒู `YOUR_WEB_APP_URL_HERE` ฺฉูุฏ:

```javascript
const CONFIG = {
    WEB_APP_URL: 'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec'
};
```

## ุนุจโุงุจ

### ูุดฺฉู: "Script function not found"
- ุจุฑุฑุณ ฺฉูุฏ ฺฉู ฺฉุฏ `apps-script.js` ุฑุง ุจู ุฏุฑุณุช ฺฉูพ ฺฉุฑุฏูโุงุฏ
- ูุทูุฆู ุดูุฏ ฺฉู ุชุงุจุน `doPost` ู `doGet` ุฏุฑ ฺฉุฏ ูุฌูุฏ ุฏุงุฑุฏ

### ูุดฺฉู: "Access denied" ุง "Permission denied"
- ุจุฑุฑุณ ฺฉูุฏ ฺฉู "Who has access" ุฑู "Anyone" ุง "Anyone with Google account" ุชูุธู ุดุฏู ุจุงุดุฏ
- ุงฺฏุฑ ุชุบุฑ ุฏุงุฏุฏุ ุจุงุฏ Deploy ุฌุฏุฏ ุจุณุงุฒุฏ

### ูุดฺฉู: "The script does not have permission"
- ุฏูุจุงุฑู Authorization ุฑุง ุงูุฌุงู ุฏูุฏ
- ุฏุฑ Apps Script Editor: **Deploy** > **Manage deployments** > ุฑู ุขฺฉูู โ๏ธ ฺฉูฺฉ ฺฉูุฏ > **Test deployments** > Authorization ุฑุง ุฏูุจุงุฑู ุงูุฌุงู ุฏูุฏ

### ูุดฺฉู: URL ฺฉุงุฑ ููโฺฉูุฏ
- ูุทูุฆู ุดูุฏ ฺฉู URL ุฑุง ฺฉุงูู ฺฉูพ ฺฉุฑุฏูโุงุฏ (ุจุงุฏ ุจุง `/exec` ุชูุงู ุดูุฏ)
- ุจุฑุฑุณ ฺฉูุฏ ฺฉู Deployment ุจู ุฏุฑุณุช ุงูุฌุงู ุดุฏู ุงุณุช

## ุจุฑูุฒุฑุณุงู ฺฉุฏ

ุงฺฏุฑ ุจุนุฏุงู ฺฉุฏ ุฑุง ุชุบุฑ ุฏุงุฏุฏ:

1. ฺฉุฏ ุฌุฏุฏ ุฑุง ุฏุฑ Apps Script Editor ุฐุฎุฑู ฺฉูุฏ
2. **Deploy** > **Manage deployments** ุฑุง ุจุงุฒ ฺฉูุฏ
3. ุฑู ุขฺฉูู โ๏ธ (Edit) ฺฉูุงุฑ deployment ููุฌูุฏ ฺฉูฺฉ ฺฉูุฏ
4. **New version** ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
5. **Deploy** ุฑุง ุจุฒูุฏ
6. **โ๏ธ ููู**: URL ุชุบุฑ ููโฺฉูุฏ - ููุงู URL ูุจู ฺฉุงุฑ ูโฺฉูุฏ

## ูฺฉุงุช ููู

- โ URL ุดูุง ููุดู ุซุงุจุช ูโูุงูุฏ (ุญุช ุจุนุฏ ุงุฒ ุจุฑูุฒุฑุณุงู)
- โ ูโุชูุงูุฏ ฺูุฏู deployment ุฏุงุดุชู ุจุงุดุฏ (ุจุฑุง ุชุณุช ู production)
- โ ูโุชูุงูุฏ deployment ูุง ูุฏู ุฑุง ุญุฐู ฺฉูุฏ
- โ๏ธ ุงฺฏุฑ Sheet ุฑุง ุจู ุญุณุงุจ ุฏฺฏุฑ ููุชูู ฺฉุฑุฏุฏุ ุจุงุฏ ุฏูุจุงุฑู Deploy ฺฉูุฏ

## ุฎูุงุตู ุชูุธูุงุช ูพุดููุงุฏ

ุจุฑุง ุดุฑูุน ุณุฑุนุ ุงู ุชูุธูุงุช ุฑุง ุงุณุชูุงุฏู ฺฉูุฏ:

```
Description: Keyhan Financial API
Execute as: Me
Who has access: Anyone
```

ุจุนุฏ ุงุฒ ุชุณุช ููููุ ูโุชูุงูุฏ "Who has access" ุฑุง ุจู "Anyone with Google account" ุชุบุฑ ุฏูุฏ.

