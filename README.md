# سیستم مدیریت مالی کیهان

یک سیستم ساده و کاربردی برای ثبت و مدیریت درآمدها و هزینه‌های فضای کار اشتراکی کیهان.

**✅ کاملاً محلی - بدون نیاز به سرور یا API**
**✅ ذخیره در مرورگر (localStorage)**
**✅ خروجی Excel**

## ویژگی‌ها

- ✅ ثبت تراکنش‌های درآمد و هزینه
- ✅ دسته‌بندی کامل با زیردسته‌ها
- ✅ تقویم شمسی برای انتخاب تاریخ
- ✅ نمایش لیست تراکنش‌ها
- ✅ ذخیره خودکار در مرورگر
- ✅ خروجی Excel
- ✅ رابط کاربری فارسی و RTL

## راه‌اندازی

### روش 1: استفاده از Python (پیشنهادی)

```bash
cd /Users/mohammadsadr/Desktop/Sadrun/keyhan_financial
python3 -m http.server 8000
```

سپس در مرورگر به آدرس `http://localhost:8000` بروید.

### روش 2: استفاده از VS Code Live Server

1. VS Code را باز کنید
2. افزونه "Live Server" را نصب کنید
3. روی فایل `index.html` راست کلیک کنید
4. "Open with Live Server" را انتخاب کنید

### روش 3: باز کردن مستقیم

می‌توانید فایل `index.html` را مستقیماً در مرورگر باز کنید (اما برخی ویژگی‌ها ممکن است کار نکنند).

## استفاده

1. صفحه را باز کنید
2. فرم را پر کنید و "ثبت تراکنش" را بزنید
3. تراکنش‌ها به صورت خودکار در مرورگر ذخیره می‌شوند
4. برای خروجی Excel، روی دکمه "📊 خروجی Excel" کلیک کنید

## ساختار دسته‌بندی‌ها

### درآمد
- اتاق‌ها
- میز اختصاصی
- میز اشتراکی (ماهانه، هفتگی، روزانه)
- اتاق جلسات (رویداد، کلاس، رزرو)
- اینترنت
- سایر

### هزینه
- حقوق و دستمزد (پایه حقوق، اضافه کار)
- قبوض (آب، برق، اینترنت، اجاره)
- مصرفی‌ها (دستمال کاغذی، شوینده، چای و قند)
- اقساط و چک
- تعمیر و نگهداری
- سایر

## نکات مهم

- ✅ داده‌ها در localStorage مرورگر ذخیره می‌شوند
- ✅ اگر Cache مرورگر را پاک کنید، داده‌ها از بین می‌روند
- ✅ برای پشتیبان‌گیری، از دکمه "خروجی Excel" استفاده کنید
- ✅ فایل Excel شامل تمام تراکنش‌ها است

## پشتیبان‌گیری

برای پشتیبان‌گیری از داده‌ها:
1. روی دکمه "📊 خروجی Excel" کلیک کنید
2. فایل Excel دانلود می‌شود
3. این فایل را در جای امنی نگه دارید

## بازگردانی داده‌ها

اگر داده‌ها را از دست دادید:
- متأسفانه localStorage فقط در همان مرورگر کار می‌کند
- اگر فایل Excel دارید، می‌توانید داده‌ها را دستی وارد کنید
- یا می‌توانید فایل Excel را به Google Sheets تبدیل کنید

## عیب‌یابی

### داده‌ها نمایش داده نمی‌شوند
- Console مرورگر را باز کنید (F12)
- بررسی کنید که خطایی وجود ندارد
- روی دکمه "🔄 بروزرسانی" کلیک کنید

### خروجی Excel کار نمی‌کند
- مطمئن شوید که کتابخانه XLSX لود شده است
- Console مرورگر را بررسی کنید
- مرورگر خود را بروزرسانی کنید

### داده‌ها از بین رفتند
- اگر Cache مرورگر را پاک کرده‌اید، داده‌ها از بین رفته‌اند
- همیشه از دکمه Excel برای پشتیبان‌گیری استفاده کنید
